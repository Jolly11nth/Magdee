import{d as S,u as E,r as g,j as e,p as i}from"./index-DfvNDOOY.js";function C({onNavigate:m}){const{status:n,isLoading:a,checkConnection:p}=S(),{user:r,getAccessToken:x}=E(),[f,l]=g.useState([]),[c,y]=g.useState(!1),b=[{name:"Health Check",test:()=>i.checkHealth()},{name:"API Status",test:()=>i.getApiStatus()},{name:"User Profile (Auth Required)",test:async()=>{if(!r)throw new Error("User not authenticated");const t=await x();if(!t)throw new Error("No access token");return i.getUserProfile(r.id,t)}},{name:"User Books",test:async()=>{if(!r)throw new Error("User not authenticated");const t=await x();if(!t)throw new Error("No access token");return i.getUserBooks(r.id,t)}},{name:"Analytics Overview",test:async()=>{if(!r)throw new Error("User not authenticated");const t=await x();if(!t)throw new Error("No access token");return i.getAnalyticsOverview(r.id,t)}}],j=async()=>{y(!0),l([]);for(const t of b){const d=Date.now();l(s=>[...s,{name:t.name,status:"pending",message:"Running..."}]);try{const s=await t.test(),h=Date.now()-d;l(u=>u.map(o=>o.name===t.name?{...o,status:s.success?"success":"error",message:s.success?"Success":s.error||"Failed",responseTime:h,data:s.data}:o))}catch(s){const h=Date.now()-d;l(u=>u.map(o=>o.name===t.name?{...o,status:"error",message:s instanceof Error?s.message:"Unknown error",responseTime:h}:o))}await new Promise(s=>setTimeout(s,100))}y(!1)};g.useEffect(()=>{p()},[p]);const k=t=>{switch(t){case"success":return"#10b981";case"error":return"#ef4444";case"pending":return"#f59e0b";default:return"#6b7280"}},w=t=>{switch(t){case"success":return"✓";case"error":return"✗";case"pending":return"⏳";default:return"○"}};return e.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:"#ffffff",display:"flex",flexDirection:"column",position:"relative"},children:[e.jsx("div",{style:{padding:"20px",borderBottom:"1px solid #E5E7EB",backgroundColor:"#ffffff"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",color:"#111827",margin:0},children:"Python Backend Test"}),e.jsx("p",{style:{fontSize:"14px",color:"#6B7280",margin:"4px 0 0 0"},children:"Test connection and functionality"})]}),e.jsx("button",{onClick:()=>m("back"),style:{padding:"8px 16px",backgroundColor:"#F3F4F6",color:"#374151",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Back"})]})}),e.jsxs("div",{style:{flex:1,padding:"20px",overflowY:"auto"},children:[e.jsxs("div",{style:{backgroundColor:"#F9FAFB",border:"1px solid #E5E7EB",borderRadius:"12px",padding:"16px",marginBottom:"20px"},children:[e.jsx("h2",{style:{fontSize:"16px",fontWeight:"600",color:"#111827",margin:"0 0 12px 0"},children:"Connection Status"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Backend Available:"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:n.available?"#10b981":"#ef4444"},children:n.available?"✓ Yes":"✗ No"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6B7280"},children:"API Status:"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:n.apiStatus?"#10b981":"#ef4444"},children:n.apiStatus?"✓ Ready":"✗ Error"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Database:"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:n.databaseConnected?"#10b981":"#ef4444"},children:n.databaseConnected?"✓ Connected":"✗ Disconnected"})]}),n.responseTime&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6B7280"},children:"Response Time:"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#374151"},children:n.responseTime<1e3?`${n.responseTime}ms`:`${(n.responseTime/1e3).toFixed(1)}s`})]})]}),n.error&&e.jsx("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#FEF2F2",border:"1px solid #FECACA",borderRadius:"8px"},children:e.jsxs("div",{style:{fontSize:"12px",fontWeight:"500",color:"#DC2626"},children:["Error: ",n.error]})})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"20px"},children:[e.jsx("button",{onClick:j,disabled:c||a,style:{padding:"12px 20px",backgroundColor:c?"#9CA3AF":"#4A90E2",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:c?"not-allowed":"pointer",flex:1},children:c?"Running Tests...":"Run All Tests"}),e.jsx("button",{onClick:p,disabled:a,style:{padding:"12px 20px",backgroundColor:"#F3F4F6",color:"#374151",border:"1px solid #D1D5DB",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:a?"not-allowed":"pointer"},children:a?"Checking...":"Recheck"})]}),f.length>0&&e.jsxs("div",{style:{backgroundColor:"#ffffff",border:"1px solid #E5E7EB",borderRadius:"12px",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"16px",borderBottom:"1px solid #E5E7EB",backgroundColor:"#F9FAFB"},children:e.jsx("h2",{style:{fontSize:"16px",fontWeight:"600",color:"#111827",margin:0},children:"Test Results"})}),e.jsx("div",{style:{padding:"0"},children:f.map((t,d)=>e.jsx("div",{style:{padding:"16px",borderBottom:d<f.length-1?"1px solid #E5E7EB":"none",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx("span",{style:{fontSize:"16px",color:k(t.status)},children:w(t.status)}),e.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#111827"},children:t.name})]}),e.jsxs("div",{style:{fontSize:"12px",color:t.status==="error"?"#DC2626":"#6B7280",marginLeft:"24px"},children:[t.message,t.responseTime&&e.jsxs("span",{style:{marginLeft:"8px"},children:["(",t.responseTime,"ms)"]})]})]})},t.name))})]}),e.jsxs("div",{style:{marginTop:"20px",padding:"16px",backgroundColor:"#F0F9FF",border:"1px solid #BFDBFE",borderRadius:"12px"},children:[e.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",color:"#1E40AF",margin:"0 0 12px 0"},children:"Quick Links"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsx("a",{href:"http://localhost:8000",target:"_blank",rel:"noopener noreferrer",style:{fontSize:"12px",color:"#1D4ED8",textDecoration:"none"},children:"→ Backend Root (Health Check)"}),e.jsx("a",{href:"http://localhost:8000/docs",target:"_blank",rel:"noopener noreferrer",style:{fontSize:"12px",color:"#1D4ED8",textDecoration:"none"},children:"→ API Documentation (Swagger)"}),e.jsx("a",{href:"http://localhost:8000/api/v1/status",target:"_blank",rel:"noopener noreferrer",style:{fontSize:"12px",color:"#1D4ED8",textDecoration:"none"},children:"→ API Status Endpoint"})]})]})]})]})}export{C as PythonBackendTestScreen,C as default};
